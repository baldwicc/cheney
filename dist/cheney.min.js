/*! Cheney for Quail quailjs.org/cheney | quailjs.org/license */
(function($) {!function(a){a.fn.cheney=function(a){return this.length?(b.options=a,b.html=this,b.run(),this):this};var b={};b.options={},b.highlightElement=function(c,d){var e=b;if(!c.element.hasClass("accessibility-result")){c.element.addClass("accessibility-result").addClass(c.severity);var f=a("<img>").attr("alt",Drupal.t("@severity error",{"@severity":Drupal.t(c.severity)})).attr("src",Drupal.settings.basePath+Drupal.settings.accessibility.icon_path+c.severity+".png"),g=a("<a>").attr("href","#accessibility-console").attr("role","command").addClass("accessibility-icon").addClass(c.severity).append(f);c.element.before(g),"undefined"==typeof d?Drupal.accessibility.attachHint(c):d(c)}var h=e.settings.tests[c.testName].testId;"undefined"==typeof e.messages[h]&&a.getJSON(Drupal.settings.basePath+"accessibility-test/"+h+"/json",function(a){e.messages[h]=a});var i=c.element.data("accessibility-tests")||{};i[e.settings.tests[c.testName].testId]=e.settings.tests[c.testName].testId,c.element.add(c.element.prev(a("accessibility-icon"))).data("accessibility-tests",i)},b.attachHint=function(b,c){c=c||a("body");var d=this;b.element.add(b.element.prev(a(".accessibility-icon"))).click(function(b){var e=a(this).data("accessibility-tests");d.errorConsole.showTests(e),a("html, body").animate({scrollTop:a(this).offset().top},10),d.errorConsole.setCurrentElement(a(this),c),b.preventDefault()})},b.cleanUpHighlight=function(b){b=b||a("html"),b.find(".accessibility-result").each(function(){a(this).removeClass("accessibility-result").removeClass("severe").removeClass("moderate").removeClass("suggestion")}),b.find(".accessibility-icon, .accessibility-icon-current").remove()},b.errorConsole={$console:!1,init:function(){if(!a("#accessibility-console").length){var b=this;a("body").append('<div id="accessibility-console" class="element-invisible">'),this.$console=a("#accessibility-console"),this.$console.append('<a name="accessibility-console">'),this.$console.append('<div class="accessibility-console-content" role="marquee">');var c=this.$console.append('<a role="button" class="close-console" href="#close" title="'+Drupal.t("close accessibility console")+'">&times;</a>');c.click(function(){return b.hide(),!1})}},show:function(){this.init(),this.$console.removeClass("element-invisible"),a("body").trigger("accessibility-console-show")},hide:function(){this.init(),this.$console.addClass("element-invisible"),a("body").trigger("accessibility-console-hide")},addTest:function(a){this.$console.append("<h3>"+Drupal.accessibility.messages[a].title+"</h3>")},showTests:function(b){var c=this;c.init();var d=c.$console.find(".accessibility-console-content");d.html(""),a.each(b,function(a,b){d.append("<h3>"+Drupal.accessibility.messages[b].title+"</h3>"),d.append(Drupal.accessibility.messages[b].content)}),c.show()},setCurrentElement:function(b,c){c=c||a("body"),c.find(".accessibility-icon-current").remove();var d=a("<img>").attr("alt",Drupal.t("Current element")).attr("role","note").addClass("accessibility-icon-current").attr("src",Drupal.settings.basePath+Drupal.settings.accessibility.icon_path+"highlighted.png");b.prev(".accessibility-icon").before(d)}}}(jQuery);